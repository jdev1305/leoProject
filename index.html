<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>R.H.V.Leonidas H13 - Goals Tracker 25/26</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Inter', sans-serif;
  margin: 20px;
  background: radial-gradient(circle at top, #121212, #1a1a1a);
  color: #e0e0e0;
}
h1 {
  text-align: center;
  margin-bottom: 20px;
  font-weight: 700;
  font-size: 2rem;
  letter-spacing: 1px;
}
.form-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  margin-bottom: 30px;
}
.form-container input, .form-container button {
  padding: 8px 12px;
  font-size: 1rem;
  border-radius: 8px;
  border: none;
  outline: none;
}
.form-container input { min-width: 120px; }
.form-container button {
  background: #007bff;
  color: #fff;
  cursor: pointer;
  transition: background 0.3s ease;
}
.form-container button:hover { background: #0056b3; }
.chart-container {
  display: flex;
  justify-content: center;
  margin-bottom: 50px;
}
canvas {
  max-width: 800px;
  width: 90%;
  height: 300px;
  background: #1e1e1e;
  padding: 15px;
  border-radius: 15px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.5);
  transition: all 0.3s ease;
}
.week-header {
  margin-top: 30px;
  font-size: 1.3em;
  font-weight: 600;
  text-align: center;
  color: #ffffff;
}
.table-card {
  background: linear-gradient(145deg, #1e1e1e, #2a2a2a);
  border-radius: 15px;
  overflow: hidden;
  box-shadow: 0 8px 20px rgba(0,0,0,0.5);
  max-width: 800px;
  margin: 20px auto;
  transition: all 0.3s ease;
}
table {
  width: 100%;
  border-collapse: collapse;
}
th, td {
  border-bottom: 1px solid #333;
  padding: 12px;
  text-align: center;
  color: #e0e0e0;
  font-weight: 500;
}
th {
  background: #007bff;
  color: #fff;
}
.remove-btn {
  margin-left: 10px;
  padding: 2px 6px;
  font-size: 0.8rem;
  border-radius: 6px;
  border: none;
  background: #ff4d4d;
  color: #fff;
  cursor: pointer;
  transition: background 0.3s ease;
}
.remove-btn:hover { background: #cc0000; }
table tr:nth-child(even) { background: #2a2a2a; }
table tr:hover { background: #333; transition: background 0.3s ease; }

@media(max-width: 600px){
  canvas { width: 100%; height: 250px; }
  table { display:block; overflow-x:auto; }
}
</style>
</head>
<body>
<h1>R.H.V.Leonidas H13 - Goals Tracker 25/26</h1>

<div class="form-container">
  <input type="text" id="weekInput" placeholder="Week Name">
  <input type="text" id="playerInput" placeholder="Player Name">
  <input type="number" id="goalsInput" placeholder="Goals" min="1">
  <button id="addGoalBtn">Add Goal</button>
  <input type="text" id="newWeekInput" placeholder="New Week Name">
  <button id="addWeekBtn">Add Week</button>
</div>

<div class="chart-container">
  <canvas id="totalGoalsChart"></canvas>
</div>

<div id="results"></div>

<script>
// Load or initialize data
let data = JSON.parse(localStorage.getItem('goalData')) || {
  "Week 1": {},
  "Week 2": {"Mees":1},
  "Week 3": {},
  "Week 4": {"Ernst":1,"Jacob":1,"Merijn":1}
};

const resultsDiv = document.getElementById("results");

// Render tables with remove buttons
function renderTables() {
  resultsDiv.innerHTML = "";
  for (const week in data) {
    const weekData = data[week];
    const tableCard = document.createElement('div');
    tableCard.className = 'table-card';
    let tableHTML = `<div class="week-header">${week}</div><table><tr><th>Player</th><th>Goals</th></tr>`;
    for (const player in weekData) {
      tableHTML += `<tr>
        <td>${player}</td>
        <td>${weekData[player]} 
          <button class="remove-btn" data-week="${week}" data-player="${player}">Remove</button>
        </td>
      </tr>`;
    }
    tableHTML += "</table>";
    tableCard.innerHTML = tableHTML;
    resultsDiv.appendChild(tableCard);
  }
}

// Dynamic colors for bars
function getColor(index) {
  const colors = ["#4BC0C0","#FF6384","#FFCE56","#36A2EB","#9966FF","#FF9F40"];
  return colors[index % colors.length];
}

let chartInstance = null;

// Render horizontal total goals chart
function renderTotalGoalsChart() {
  const totals = {};
  for (const week in data) {
    for (const player in data[week]) {
      totals[player] = (totals[player] || 0) + data[week][player];
    }
  }

  const sortedTotals = Object.entries(totals).sort((a,b) => b[1]-a[1]);
  const labels = sortedTotals.map(e => e[0]);
  const values = sortedTotals.map(e => e[1]);

  const ctx = document.getElementById("totalGoalsChart").getContext("2d");
  if(chartInstance) chartInstance.destroy();

  chartInstance = new Chart(ctx, {
    type: "bar",
    data: {
      labels: labels,
      datasets: [{
        label: "Total Goals",
        data: values,
        backgroundColor: labels.map((_, i) => getColor(i)),
        borderRadius: 10,
        barThickness: 30,
        hoverBackgroundColor: "#00FFFF"
      }]
    },
    options: {
      indexAxis: 'y',
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          bodyFont: { size: 16 },
          titleFont: { size: 16, weight: 'bold' },
          padding: 12,
          backgroundColor: '#333',
          titleColor: '#fff',
          bodyColor: '#fff',
          callbacks: {
            label: function(context) {
              return `${context.label}: ${context.parsed.x} goal${context.parsed.x !== 1 ? 's' : ''}`;
            }
          }
        }
      },
      scales: {
        x: { beginAtZero: true, stepSize: 1, ticks: { color: '#e0e0e0', callback: v => Number.isInteger(v)?v:null, precision:0 }, grid:{ color:'#333' } },
        y: { grid:{color:'#333'}, ticks:{ font:{weight:'bold', size:24}, color:'#ffffff' } }
      }
    }
  });
}

// Add goal from form
document.getElementById('addGoalBtn').addEventListener('click', () => {
  const week = document.getElementById('weekInput').value.trim();
  const player = document.getElementById('playerInput').value.trim();
  const goals = parseInt(document.getElementById('goalsInput').value);

  if(!week || !player || isNaN(goals) || goals < 1) return alert("Please fill in all fields correctly.");

  if(!data[week]) data[week] = {};
  data[week][player] = (data[week][player] || 0) + goals;

  localStorage.setItem('goalData', JSON.stringify(data));
  renderTables();
  renderTotalGoalsChart();

  document.getElementById('weekInput').value = '';
  document.getElementById('playerInput').value = '';
  document.getElementById('goalsInput').value = '';
});

// Add new empty week
document.getElementById('addWeekBtn').addEventListener('click', () => {
  const week = document.getElementById('newWeekInput').value.trim();
  if(!week) return alert("Please enter a week name.");
  if(data[week]) return alert("Week already exists!");

  data[week] = {}; // empty week with zero goals
  localStorage.setItem('goalData', JSON.stringify(data));
  renderTables();
  renderTotalGoalsChart();

  document.getElementById('newWeekInput').value = '';
});

// Remove goal handler with confirmation
document.addEventListener('click', function(e){
  if(e.target.classList.contains('remove-btn')){
    const week = e.target.dataset.week;
    const player = e.target.dataset.player;

    if(confirm(`Are you sure you want to remove all goals for ${player} in ${week}?`)){
      delete data[week][player];
      if(Object.keys(data[week]).length === 0) delete data[week];

      localStorage.setItem('goalData', JSON.stringify(data));
      renderTables();
      renderTotalGoalsChart();
    }
  }
});

// Initialize
document.addEventListener("DOMContentLoaded", () => {
  renderTotalGoalsChart();
  renderTables();
});
</script>
</body>
</html>
